"""
JLS 중학교 전략 설명회 PPT 생성 및 폰트 조정 도구

기능:
1. PPT 생성 시 폰트 크기 직접 지정
2. 기존 PPT 파일의 폰트 크기 조정

사용법:
1. 기본 사용: python ppt.py
2. 폰트 조정: adjust_font_size('파일명.pptx', scale_factor=0.8)

예시:
- 20% 작게: adjust_font_size('file.pptx', 0.8)
- 20% 크게: adjust_font_size('file.pptx', 1.2)
- 50% 작게: adjust_font_size('file.pptx', 0.5)
"""

from pptx import Presentation
from pptx.util import Pt
import logging
import os

# 로깅 설정
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

def adjust_font_size(pptx_path, scale_factor=0.8, output_suffix='_폰트조정'):
    """
    PPT 파일의 모든 폰트 크기를 조정합니다.
    
    Args:
        pptx_path (str): 입력 PPT 파일 경로
        scale_factor (float): 폰트 크기 조정 비율 (0.8 = 20% 축소, 1.2 = 20% 확대)
        output_suffix (str): 출력 파일명에 추가할 접미사
    
    Returns:
        str: 생성된 파일 경로
    """
    try:
        logger.info(f"폰트 조정 시작: {pptx_path}")
        prs = Presentation(pptx_path)
        adjusted_count = 0
        
        for slide_idx, slide in enumerate(prs.slides, 1):
            for shape in slide.shapes:
                if hasattr(shape, "text_frame") and shape.text.strip():
                    for paragraph in shape.text_frame.paragraphs:
                        for run in paragraph.runs:
                            if run.font.size is not None:
                                current_size = run.font.size.pt
                                new_size = max(8, min(72, int(current_size * scale_factor)))
                                run.font.size = Pt(new_size)
                                adjusted_count += 1
                                
                                logger.debug(f"슬라이드 {slide_idx}: {current_size}pt → {new_size}pt")
        
        # 출력 파일명 생성
        base_name = pptx_path.rsplit('.', 1)[0]
        output_path = f"{base_name}{output_suffix}.pptx"
        
        prs.save(output_path)
        logger.info(f"폰트 조정 완료: {adjusted_count}개 텍스트 수정됨")
        logger.info(f"저장된 파일: {output_path}")
        
        return output_path
        
    except Exception as e:
        logger.error(f"폰트 조정 중 오류 발생: {str(e)}")
        raise

def create_presentation_with_font_control(slide_data, filename, title_size=18, content_size=11):
    """
    폰트 크기를 지정해서 PPT를 생성합니다.
    
    Args:
        slide_data (list): 슬라이드 데이터 (제목, 내용) 튜플 리스트
        filename (str): 저장할 파일명
        title_size (int): 제목 폰트 크기
        content_size (int): 내용 폰트 크기
    
    Returns:
        str: 생성된 파일 경로
    """
    prs = Presentation()
    
    for slide_idx, (title, content) in enumerate(slide_data, 1):
        slide = prs.slides.add_slide(prs.slide_layouts[1])  # 제목+본문 레이아웃
        
        # 제목 설정 및 폰트 조정
        if title:
            slide.shapes.title.text = title
            for paragraph in slide.shapes.title.text_frame.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(title_size)
                    run.font.name = '맑은 고딕'
        else:
            slide.shapes.title.text = " "
        
        # 내용 설정 및 폰트 조정
        if content:
            try:
                content_placeholder = slide.placeholders[1]
                content_placeholder.text = content
                
                for paragraph in content_placeholder.text_frame.paragraphs:
                    for run in paragraph.runs:
                        run.font.size = Pt(content_size)
                        run.font.name = '맑은 고딕'
                        
            except Exception as e:
                logger.warning(f"슬라이드 {slide_idx} 내용 설정 실패: {str(e)}")
                pass
    
    prs.save(filename)
    logger.info(f"PPT 생성 완료: {filename}")
    logger.info(f"제목 폰트: {title_size}pt, 내용 폰트: {content_size}pt")
    
    return filename

def quick_font_adjust(pptx_path, size='small'):
    """
    빠른 폰트 조정 도구
    
    Args:
        pptx_path (str): PPT 파일 경로
        size (str): 'small'(80%), 'medium'(90%), 'large'(110%), 'xlarge'(120%)
    """
    size_map = {
        'small': 0.8,
        'medium': 0.9,
        'large': 1.1,
        'xlarge': 1.2
    }
    
    if size not in size_map:
        print(f"오류: '{size}'는 지원되지 않는 크기입니다. 사용 가능: {list(size_map.keys())}")
        return None
    
    scale_factor = size_map[size]
    output_suffix = f'_{size}'
    
    return adjust_font_size(pptx_path, scale_factor, output_suffix)

# 100슬라이드 제목과 내용 리스트
slide_data = [
    ("2025 중학교 전략 선택 설명회", 
     "우리 아이의 미래를 여는 첫 번째 선택\n\n일시: 2025년 9월 27일 (토) 오전 11시\n장소: JLS 정상어학원 청라캠퍼스 세미나실\n대상: 초등학교 6학년 학생 및 학부모"),
    
    ("강사 소개", 
     "• 김정상 원장\n  - 서울대학교 영어교육학과 졸업\n  - 15년간 중고등 영어교육 전문\n  - 특목고 진학 컨설팅 500명+ 지도\n  - 청라 지역 교육 전문가"),
    
    ("JLS 정상어학원 소개", 
     "• 15년 전통의 청라 지역 대표 영어교육기관\n• 청라 지역 특목고 진학률 1위\n• 소논문 지도 전문 프로그램 운영\n• 개별 맞춤형 학습 관리 시스템\n• 학부모 만족도 95% 이상"),
    
    ("오늘의 목표", 
     "1. 중학교 진학이 단순한 배정이 아님을 인식\n\n2. 고등학교-대학까지 연결되는 첫 출발선임을 이해\n\n3. 우리 아이만의 맞춤형 전략 수립"),
    
    ("세미나 구성", 
     "• Section 1: 교육제도 변화와 대응 (30분)\n• Section 2: 청라 지역 중학교 현황 (20분)\n• Section 3: 전략적 선택 방법 (20분)\n• Section 4: 예비중학생 준비법 (25분)\n• Section 5: 학부모 역할 (10분)\n• Section 6: JLS 프로그램 소개 (8분)\n• 마무리 및 Q&A (7분)"),
    
    ("교육 패러다임의 대전환", 
     "2025년, 무엇이 달라지는가?\n\n• 5등급제 도입\n• 고교학점제 전면 시행\n• 특목·자사고 정책 변화\n• AI 디지털교과서 도입\n\n→ 중학교부터 전략적 사고 필수!"),
    
    ("5등급제 도입", 
     "현행 9등급제 → 2025년 5등급제\n\n【현재】\n• 상대평가 9등급\n• 치열한 등급 경쟁\n\n【2025년】\n• 절대평가 5등급\n• 내신 경쟁 완화\n• 특목고 진학 기회 확대"),
    
    ("내신 경쟁 완화 효과", 
     "5등급제로 인한 변화\n\n• 1등급 비율: 4% → 20%\n• 2등급 비율: 11% → 30%\n• 내신 부담 감소\n• 비교과 활동 중요성 증대\n• 진로 탐색 시간 확보"),
    
    ("특목고/자사고 수혜 전망", 
     "5등급제가 특목고에 유리한 이유\n\n• 내신 부담 감소로 심화 학습 가능\n• 비교과 활동 집중 투자 기회\n• 창의적 사고력 계발 시간 확보\n• 특목고 특화 프로그램 준비 여유\n\n→ 전략적 준비의 중요성 증대"),
    
    ("고교학점제 개요", 
     "학생이 진로에 따라 과목 선택\n\n• 필수과목 + 선택과목 조합\n• 개인별 맞춤형 교육과정\n• 진로 적성에 맞는 심화 학습\n• 대학 전공과 직접 연계\n\n→ 중학교 때부터 진로 탐색 필수!"),
    
    ("중학교 준비 방향성", 
     "진로탐색이 핵심!\n\n• 다양한 분야 체험 활동\n• 적성과 흥미 발견\n• 진로 연계 심화 학습\n• 장기적 학습 계획 수립\n• 자기주도적 학습 습관 형성"),
    
    ("특목/자사고 정책 2025 방향", 
     "주요 정책 변화\n\n• 선발 방식 다양화\n• 창의성 평가 비중 증가\n• 면접 및 실기 강화\n• 지역 연계 프로그램 확대\n\n→ 단순 암기형 준비로는 한계"),
    
    ("지역 균형 선발 확대", 
     "특목고 지역별 배정 비율 증가\n\n• 서울 집중 → 전국 분산\n• 청라 지역 기회 확대\n• 지역 내 경쟁 심화\n• 차별화된 준비 전략 필요\n\n→ 우리 지역 특성 이해 중요"),
    
    ("전략적 사고가 필요한 시대", 
     "중학교 선택의 새로운 의미\n\n• 단순 근거리 배정 ❌\n• 전략적 교육 투자 ⭕\n• 장기적 관점 필요\n• 데이터 기반 결정\n• 개별 맞춤형 접근"),
    
    ("변하지 않는 입시 3요소", 
     "어떤 제도 변화에도 불변\n\n1️⃣ 내신 (교과 성적)\n2️⃣ 비교과 (특별활동, 동아리, 봉사)\n3️⃣ 학업역량 (사고력, 문제해결력)\n\n→ 균형잡힌 준비가 핵심"),
    
    ("내신 비중 변화", 
     "【과거】 내신 70% : 수능 30%\n【현재】 내신 50% : 수능 30% : 비교과 20%\n【미래】 내신 40% : 역량 40% : 비교과 20%\n\n→ 단순 점수보다 종합적 역량 평가"),
    
    ("비교과 활동의 질적 변화", 
     "양적 확대 → 질적 심화\n\n【이전】\n• 많은 활동 경험\n• 수상 실적 위주\n\n【현재】\n• 깊이 있는 탐구\n• 진로 연관성\n• 지속성과 발전성\n• 창의적 문제해결"),
    
    ("진로·창의성 연관 활동", 
     "특목고가 원하는 활동\n\n• 소논문 작성 및 발표\n• 교내외 탐구대회 참여\n• 진로 연계 봉사활동\n• 동아리 리더십 경험\n• 창의적 프로젝트 수행\n\n→ JLS에서 체계적 지도!"),
    
    ("학업역량의 재정의", 
     "암기형 → 사고력 중심\n\n【기존】 많이 외우기\n【현재】 깊게 생각하기\n\n• 비판적 사고력\n• 창의적 문제해결\n• 의사소통 능력\n• 협업 능력\n• 자기주도학습"),
    
    ("영어 학습의 핵심", 
     "4대 영역 통합 접근\n\n🗣️ Speaking: 유창성 + 정확성\n👂 Listening: 다양한 억양 이해\n📖 Reading: 비판적 독해력\n✍️ Writing: 논리적 글쓰기\n\n→ 수행평가 시대 필수 역량"),
    
    ("수행평가 70% 시대 대응", 
     "중학교 영어 평가 변화\n\n• 지필평가 30% : 수행평가 70%\n• 말하기·쓰기 비중 급증\n• 프로젝트 기반 평가\n• 창의적 표현 능력 중시\n\n→ JLS 특화 프로그램으로 완벽 대비"),
    
    ("초등 vs 중등 비교", 
     "【학습량】 초등 100 → 중등 200\n【난이도】 구체적 → 추상적 사고\n【자율성】 수동적 → 자기주도적\n【평가】 절대평가 → 상대평가\n【경쟁】 무경쟁 → 치열한 경쟁\n\n→ 충격적 변화! 미리 준비 필수"),
    
    ("중1 충격기 분석", 
     "성적 하락 패턴\n\n📊 평균 성적 하락률: 30%\n📊 적응 기간: 평균 6개월\n📊 완전 회복: 1년 이상 소요\n\n원인: 학습량 급증 + 난이도 상승 + 환경 변화\n\n→ 사전 준비로 충격 최소화 가능"),
    
    ("학교별 교육 철학 차이", 
     "【인문형】 문학·역사·철학 중심\n【수리형】 수학·과학·논리 중심\n【종합형】 다양한 분야 균형 발전\n\n→ 우리 아이 성향에 맞는 학교 선택이 중요!\n→ 미스매치 시 부적응 위험"),
    
    ("Section 1 핵심 요약", 
     "중학교 = 인생의 첫 번째 전략적 선택\n\n✅ 교육제도 대변화 시대\n✅ 5등급제로 기회 확대\n✅ 진로탐색의 중요성 급증\n✅ 내신·비교과·역량 균형 준비\n✅ 전략적 사고 필수\n\n→ 지금부터 체계적 준비 시작!"),
    
    ("청라 교육 인프라", 
     "우리 동네 교육 환경\n\n👥 인구: 110,000명\n🏫 중학교: 7개교\n🎓 고등학교: 4개교 (신설 예정 1개)\n📚 학원가: 청라 에듀타운\n\n특징: 계획도시의 체계적 교육 인프라"),
    
    ("청라 지역 특성", 
     "【장점】\n• 신도시 계획적 개발\n• 우수한 교육 시설\n• 높은 교육열\n• 다양한 교육 프로그램\n\n【과제】\n• 고등학교 부족 (통학 거리)\n• 치열한 내부 경쟁\n• 상대적 높은 교육비"),
    
    ("청라중학교 심층 분석", 
     "🏫 설립: 2012년 | 학급: 36개\n\n【특징】\n• 영어교육 특화 프로그램\n• 국제교류 활발 (자매결연 3개국)\n• 원어민 교사 4명 상주\n\n【2024 진학실적】\n• 외대부고 7명 | 대일외고 4명\n• 과학고 3명 | 국제고 5명"),
    
    ("청람중학교 심층 분석", 
     "🏫 설립: 2015년 | 학급: 42개\n\n【특징】\n• 수학·과학 심화교육\n• 창의융합 프로그램 운영\n• R&E 연구 프로젝트 활발\n\n【2024 진학실적】\n• 과학고 8명 | 영재학교 2명\n• 외대부고 5명 | 자사고 3명"),
    
    ("해원중학교 심층 분석", 
     "🏫 설립: 2018년 | 학급: 30개\n\n【특징】\n• 소규모 정예 교육\n• 개별 맞춤 지도 시스템\n• 1:1 진학 멘토링\n\n【2024 진학실적】\n• 특목고 진학률 상위 10%\n• 학생 1인당 교사 관심도 최고\n• 학부모 만족도 4.8/5.0"),
    
    ("초은중학교 심층 분석", 
     "🏫 설립: 2016년 | 학급: 39개\n\n【특징】\n• 인문사회 중심 교육\n• 토론·발표 수업 강화\n• 독서·글쓰기 프로그램 우수\n\n【2024 진학실적】\n• 외대부고 6명 | 국제고 4명\n• 인문계 특목고 강세\n• 논술전형 합격률 높음"),
    
    ("신설 중학교 특성", 
     "【루원중】2019년 개교\n• 최신 스마트 교육 시설\n• 젊은 교사진 (평균 연령 32세)\n\n【청호중】2020년 개교\n• AI·SW 교육 특화\n\n【경연중】2022년 개교\n• 아직 충분한 진학 데이터 부족\n• 개척 정신으로 새로운 시도"),
    
    ("중학교별 포지셔닝", 
     "📊 학업분위기 vs 특목고진학률 매트릭스\n\n🔥 청람중: 높은분위기 + 높은진학률\n⭐ 청라중: 높은분위기 + 중간진학률\n💎 해원중: 중간분위기 + 높은진학률\n📚 초은중: 높은분위기 + 중간진학률\n🆕 신설교: 보통분위기 + 데이터부족"),
    
    ("특목고 진학 5개년 트렌드", 
     "【2020-2024 누적 실적】\n\n1위 청람중: 34명\n2위 청라중: 28명\n3위 초은중: 22명\n4위 해원중: 18명\n5위 기타: 15명\n\n→ 상위 4개교가 전체의 85% 차지"),
    
    ("일반고 진학 현황", 
     "【인천 지역 선호교】\n• 인천하늘고, 부개고, 인천고\n• 통학 시간 30-40분\n\n【서울 지역】\n• 통학 시간 1시간 30분 이상\n• 현실적 어려움 존재\n\n→ 2027년 청라4고 개교로 개선 예정"),
    
    ("국제학교 진학 데이터", 
     "【채드윅 국제학교】\n• 영어: 원어민 수준 필수\n• 특별활동: 글로벌 리더십\n• 청라 지역 연 5-7명 진학\n\n【KMLA】\n• 수학·과학 + 영어 균형\n• 청라 지역 연 8-10명 진학"),
    
    ("학부모 만족도 조사", 
     "2024년 청라 지역 중학교 만족도\n\n📊 해원중: 4.8/5.0 (개별관심)\n📊 청람중: 4.5/5.0 (진학지도)\n📊 청라중: 4.2/5.0 (영어교육)\n📊 초은중: 4.0/5.0 (인문교육)\n\n전체 평균: 4.4/5.0"),
    
    ("배정 경쟁률 분석", 
     "【1지망 충족률】\n• 청라 지역 평균: 73%\n• 전국 평균: 65%\n\n【배정 우선순위】\n1. 거주지역 (70%)\n2. 형제자매 재학 (20%)\n3. 추첨 (10%)\n\n→ 전략적 1지망 선택이 핵심!"),
    
    ("Section 2 핵심 요약", 
     "데이터 기반 현명한 선택\n\n✅ 청라 7개 중학교 각각 특색 존재\n✅ 진학실적도 학교별 차이 명확\n✅ 1지망 충족률 73% = 전략적 선택 중요\n✅ 우리 아이 성향과 학교 문화 매칭\n\n→ 감정이 아닌 사실 기반 결정!"),
    
    ("1지망 선택의 파워", 
     "운명을 바꾸는 한 번의 선택\n\n📈 1지망 배정률: 73%\n📉 2지망 배정률: 18%\n📉 3지망 배정률: 9%\n\n→ 원하는 학교 갈 확률 4배 차이!\n→ 1지망 선택이 중학교 3년을 결정"),
    
    ("배정 시스템 이해", 
     "【추첨 방식】\n• 거주지역별 블록 배정\n• 컴퓨터 무작위 추첨\n• 형제자매 가점 적용\n\n【전략 포인트】\n• 경쟁률 예측이 핵심\n• 과거 데이터 분석 필수\n• 안전판 확보 중요"),
    
    ("과거 경쟁률 패턴", 
     "【고경쟁교 (1.5:1 이상)】\n• 청람중: 1.8:1\n• 청라중: 1.6:1\n\n【중경쟁교 (1.2-1.5:1)】\n• 초은중: 1.3:1\n• 해원중: 1.2:1\n\n【안정교 (1.2:1 미만)】\n• 신설교들: 0.9-1.1:1"),
    
    ("학생 성향 진단", 
     "우리 아이는 어떤 타입?\n\n🎯 공부형: 학업성취 최우선\n🎭 활동형: 리더십·특별활동 중시\n🛡️ 안정형: 착실한 기본기 선호\n\n→ 성향과 학교 문화 일치가 성공의 열쇠!\n→ 미스매치 시 부적응 위험"),
    
    ("공부형 학생 맞춤 전략", 
     "【추천 학교】청람중, 청라중\n\n【선택 이유】\n• 우수한 교사진과 시설\n• 체계적 교육과정\n• 높은 특목고 진학률\n• 학업 중심 분위기\n\n【주의점】경쟁 심화로 스트레스 가능"),
    
    ("활동형 학생 맞춤 전략", 
     "【추천 학교】초은중, 해원중\n\n【선택 이유】\n• 다양한 비교과 프로그램\n• 개별 관심과 지원\n• 리더십 발휘 기회\n• 창의적 활동 장려\n\n【주의점】학업과 활동의 균형 필요"),
    
    ("안정형 학생 맞춤 전략", 
     "【추천 학교】루원중, 청호중, 경연중\n\n【선택 이유】\n• 소규모 학급 운영\n• 세심한 개별 관리\n• 부담 없는 학습 분위기\n• 기본기 탄탄히 다지기 가능\n\n【주의점】진학 정보 부족 가능성"),
    
    ("성공 케이스 1 - 공부형", 
     "👦 김민수 (청람중 → 대일외고)\n\n【선택 이유】\n• 수학·과학 심화과정 매력\n• 높은 특목고 진학률\n\n【3년 과정】\n• 중1-2: 교과 성적 상위 5% 유지\n• 중3: R&E 프로젝트 대상 수상\n\n【결과】대일외고 수석 합격"),
    
    ("성공 케이스 2 - 활동형", 
     "👧 박지혜 (초은중 → 인천국제고)\n\n【선택 이유】\n• 토론·발표 중심 수업\n• 국제교류 프로그램 풍부\n\n【3년 과정】\n• 중1: 영어토론부 가입\n• 중2: 학생회 부회장\n• 중3: 모의유엔 대표\n\n【결과】인천국제고 당당히 합격"),
    
    ("성공 케이스 3 - 안정형", 
     "👦 이준호 (해원중 → 인천하늘고)\n\n【선택 이유】\n• 소규모 정예 교육 선호\n• 개별 맞춤 지도 기대\n\n【3년 과정】\n• 꾸준한 상위 20% 성적 유지\n• 차분한 성격으로 성실 학습\n• 교사 추천서 만점\n\n【결과】목표했던 명문 일반고 진학"),
    
    ("실패 케이스 분석", 
     "❌ 실패 사례\n• 공부형 → 활동 중심 학교 진학\n• 결과: 부적응으로 성적 하락\n\n❌ 실패 원인\n• 성향과 학교 문화 불일치\n• 사전 정보 수집 부족\n• 주변 권유만으로 결정\n\n→ 신중한 사전 조사 필수!"),
    
    ("선택 체크리스트", 
     "🔍 우리 아이 성향 파악\n• 학습 스타일은?\n• 성격 유형은?\n• 관심 분야는?\n\n🔍 학교 정보 수집\n• 홈페이지 상세 확인\n• 설명회 적극 참석\n• 재학생·학부모 인터뷰\n\n🔍 가족 상황 고려\n• 통학 거리 | 경제적 여건"),
    
    ("Section 3 핵심 요약", 
     "성향별 맞춤 전략이 핵심\n\n✅ 1지망 선택이 운명 결정\n✅ 성향과 학교 문화 매칭 중요\n✅ 데이터 기반 전략적 접근\n✅ 사전 정보 수집 필수\n\n→ 지금부터 체계적 정보 수집 시작!"),
    
    ("예비중학생 준비 로드맵", 
     "지금 시작하는 차이가 3년을 좌우\n\n📅 초6 겨울방학: 기본기 완성\n📅 중1 1학기: 적응 + 습관 형성\n📅 중1 2학기: 본격 성적 관리\n📅 중2 전체: 심화 학습 + 비교과\n📅 중3 전체: 진학 준비 집중\n\n→ 단계별 목표 달성이 성공 비결!"),
    
    ("시기별 세부 전략", 
     "【초6 겨울】기본기 완성\n• 국영수 교과서 완전 이해\n• 자기주도 학습 습관 형성\n\n【중1 1학기】적응기\n• 중학교 시스템 적응\n• 새로운 교우관계 형성\n\n【중1 2학기】본격 시작\n• 내신 관리 시스템 구축\n• 비교과 활동 계획 수립"),
    
    ("학습 역량 체크리스트", 
     "✅ 기초 학력\n• 국/영/수 교과서 80% 이상 이해\n• 기본 개념 완벽 숙지\n\n✅ 학습 습관\n• 하루 2시간 이상 자기주도학습\n• 꾸준한 학습 패턴 유지\n\n✅ 시간 관리\n• 계획표 작성 및 실행\n• 우선순위 설정 능력"),
    
    ("중학 영어의 새로운 도전", 
     "수행평가 70% 시대의 특징\n\n【변화】\n• 지필고사 30% → 수행평가 70%\n• 4대 영역 통합 평가\n• 창의적 표현 중시\n\n【대응 전략】\n• Speaking & Writing 집중\n• 프로젝트 수행 능력\n• 협업 및 발표 역량"),
    
    ("Writing 능력 집중 개발", 
     "【중요성】수행평가 25% 차지\n\n【현재 수준 진단】\n• 영어 일기 쓰기 가능?\n• 3문단 에세이 작성 가능?\n\n【목표 수준】\n• 100단어 에세이 유창하게\n• 논리적 구조 갖춘 글쓰기\n\n→ JLS 라이팅 집중반 추천!"),
    
    ("Speaking 능력 집중 개발", 
     "【중요성】발표 수행평가 20% 차지\n\n【현재 수준 진단】\n• 영어로 자기소개 3분 가능?\n• 주제 발표 자신감 있나?\n\n【목표 수준】\n• 5분 발표 자신감 있게\n• 질의응답까지 완벽하게\n\n→ JLS 스피킹 전문반 운영!"),
    
    ("교내 대회 전략적 준비", 
     "【영어 말하기 대회】매년 11월\n• 전체 학생 대상\n• 특목고 스펙 필수\n\n【영어 독서 감상문】매년 9월\n• 창의적 표현 평가\n• 깊이 있는 독해력 요구\n\n【전략】중1부터 적극 참여\n→ 실력 향상 + 스펙 완성"),
    
    ("중학 수학의 도전", 
     "초등과 완전히 다른 세계\n\n【난이도 변화】\n• 구체적 → 추상적 사고\n• 계산 → 개념 이해 중심\n• 초등 대비 3배 어려워짐\n\n【대응 전략】\n• 개념 완벽 이해 우선\n• 충분한 연습량 확보\n• 단계별 점진적 학습"),
    
    ("수학 개념 완성 전략", 
     "【기본기 점검】\n• 사칙연산 정확성 100%\n• 분수·소수 완벽 이해\n• 비례·비율 개념 명확\n\n【중학 연계】\n• 문자와 식 기초\n• 좌표평면 개념\n• 기하 기본 도형\n\n→ 선행보다 깊이 있는 이해!"),
    
    ("수학 교과 심화 준비", 
     "【학교별 차이점】\n• 청람중: 경시대회 수준까지\n• 청라중: 사고력 문제 중심\n• 기타교: 교과서 + α\n\n【대응 방법】\n• 교과서 완벽 숙지 후\n• 심화 문제집 1권 추가\n• 사고력 문제 꾸준히 연습"),
    
    ("자기주도학습 기초", 
     "중학교 성공의 핵심 열쇠\n\n【계획 수립】\n• 주간/월간 학습계획표\n• 구체적 목표 설정\n\n【실행 능력】\n• 집중시간 점진적 확대\n• 유혹 요소 차단\n\n【점검 시스템】\n• 매일 학습일지 작성\n• 주간 성과 분석"),
    
    ("독서 습관 체계적 형성", 
     "모든 과목의 기초 체력\n\n【목표】월 3권 이상\n• 교과 연계 도서 포함\n• 다양한 장르 경험\n\n【방법】\n• 독서록 꾸준히 작성\n• 가족 독서 토론\n• 도서관 정기 방문\n\n【효과】국어 실력 + 배경지식 향상"),
    
    ("소논문 준비의 중요성", 
     "특목고 진학 필수 스펙\n\n【시작】관심 분야 주제 선정\n• 진로 연계성 고려\n• 탐구 가능한 주제\n\n【과정】자료수집 → 분석 → 글쓰기\n• 객관적 자료 활용\n• 논리적 구성\n\n→ JLS 소논문 전문 지도!"),
    
    ("발표 능력 체계적 개발", 
     "모든 과목 수행평가 필수\n\n【필요성】\n• 중학교 전 과목 발표 포함\n• 자신감 있는 표현 중시\n\n【연습 방법】\n• 가족 앞 발표 연습\n• 친구들과 토론 활동\n• 발표 동영상 촬영 분석\n\n【목표】당당하고 설득력 있는 발표"),
    
    ("동아리 활동 전략", 
     "진로 연계성이 핵심\n\n【선택 기준】\n• 흥미 < 진로 연관성\n• 지속 가능한 활동\n\n【참여 방식】\n• 수동적 참여 ❌\n• 능동적 기여 ⭕\n• 리더십 경험 중요\n\n【결과물】포트폴리오 체계적 관리"),
    
    ("Section 4 핵심 요약", 
     "지금부터 중학교 준비 시작!\n\n✅ 영어: 쓰기·말하기 집중\n✅ 수학: 개념 완성 후 심화\n✅ 자기주도학습 습관 형성\n✅ 독서·소논문·발표 준비\n✅ 진로 연계 비교과 활동\n\n→ 체계적 준비가 성공의 열쇠!"),
    
    ("현명한 학부모의 역할", 
     "과보호 vs 방치, 그 사이의 균형\n\n❌ 과보호: 모든 것을 대신\n❌ 방치: 무관심과 방임\n⭕ 균형: 지원자 역할 충실\n\n→ 아이의 자립성과 성취감\n   동시에 추구하는 현명함 필요"),
    
    ("생활 습관 지원 방법", 
     "【수면】최소 8시간 확보\n• 성장기 필수 수면시간\n• 학습 효율성과 직결\n\n【식사】아침식사 100%\n• 뇌 활동 에너지 공급\n• 균형잡힌 영양 섭취\n\n【운동】주 3회 이상\n• 스트레스 해소\n• 체력 관리"),
    
    ("시간 관리 도움 방법", 
     "【계획표 작성】\n• 함께 작성 → 점진적 독립\n• 현실적이고 구체적으로\n\n【우선순위 교육】\n• 중요도 vs 긴급도 매트릭스\n• 선택과 집중 원리\n\n【휴식시간 보장】\n• 적절한 여가활동\n• 번아웃 방지"),
    
    ("최적 학습환경 조성", 
     "【물리적 공간】\n• 독립적 학습공간 마련\n• 정리정돈된 책상\n• 적절한 조명과 온도\n\n【심리적 환경】\n• 조용하고 집중 가능한 분위기\n• 방해 요소 최소화\n• 격려와 지지의 말"),
    
    ("진로 탐색 함께하기", 
     "고교학점제 대비 필수 과정\n\n【중요성】\n• 중1부터 시작해야 하는 이유\n• 진로에 따른 과목 선택\n\n【방법】\n• 다양한 직업군 체험\n• 적성과 흥미 발견\n• 장단점 객관적 분석\n\n→ 체계적이고 지속적 탐색 중요"),
    
    ("학교 정보 함께 수집", 
     "【학교 설명회】함께 참석\n• 직접 보고 느끼는 기회\n• 궁금한 점 즉석 질문\n\n【홈페이지 정기 확인】\n• 교육과정 상세 분석\n• 특색 프로그램 파악\n\n【인터뷰 기회 마련】\n• 재학생·졸업생 만남\n• 생생한 경험담 청취"),
    
    ("다양한 경험 기회 제공", 
     "【체험 활동】\n• 진로 박람회 참석\n• 직업 체험 프로그램\n• 대학 캠퍼스 견학\n\n【만남의 기회】\n• 다양한 직업군 멘토\n• 선배들과의 대화\n• 전문가 특강 참석\n\n→ 간접 경험을 통한 시야 확장"),
    
    ("과도한 개입 부작용", 
     "❌ 의존성 증가\n• 스스로 결정할 기회 박탈\n• 자립심 발달 저해\n\n❌ 스트레스 증가\n• 과도한 기대 압박\n• 완벽주의 강요\n\n❌ 관계 악화\n• 반항심리 증가\n• 소통 단절 가능성"),
    
    ("적절한 지원 수준", 
     "【정보 제공자 역할】\n• 객관적 데이터 수집\n• 다양한 선택지 제시\n\n【최종 결정 존중】\n• 아이가 주체적 선택\n• 결과에 대한 책임감 학습\n\n【실패도 성장 과정】\n• 시행착오 허용\n• 회복 탄력성 기르기"),
    
    ("데이터 기반 의사결정", 
     "감정보다 사실 중심\n\n【객관적 지표 활용】\n• 진학률, 만족도 등 수치\n• 전문가 의견 참조\n\n【비교 대상 설정】\n• 남의 아이 ❌\n• 우리 아이 성장 과정 ⭕\n\n【장기적 관점】\n• 단기 성과에 연연하지 않기\n• 꾸준한 발전 추구"),
    
    ("Section 5 핵심 요약", 
     "지원자 역할, 결정자 아님\n\n✅ 생활습관·환경 지원\n✅ 정보 수집 함께하기\n✅ 적절한 거리 유지\n✅ 데이터 기반 판단\n✅ 아이 선택 존중\n\n→ 자립성과 성취감 동시 추구"),
    
    ("JLS 성공 로드맵", 
     "15년 노하우의 체계적 교육\n\n🎯 개별 맞춤형 진단\n🎯 단계별 학습 설계\n🎯 전문 강사진 1:1 지도\n🎯 정기 상담 및 점검\n🎯 진학까지 완벽 관리\n\n→ 우리 아이만의 성공 스토리 만들기"),
    
    ("JLS 핵심 차별화 역량", 
     "【소논문 지도】전문 강사진 1:1\n• 주제 선정부터 완성까지\n• 특목고 합격생 100% 보유\n\n【대회 준비반】각종 경시대회\n• 교내외 대회 집중 훈련\n• 수상 실적으로 스펙 완성\n\n【수행평가 대비】중학교별 맞춤\n• 학교 특성 완벽 분석\n• 내신 1등급 달성 시스템"),
    
    ("소논문 프로그램 상세", 
     "특목고 진학의 필수 관문\n\n【체계적 과정】\n1️⃣ 주제 선정 (진로 연계)\n2️⃣ 자료 조사 (객관적 근거)\n3️⃣ 논문 작성 (논리적 구성)\n4️⃣ 발표 (설득력 있는 프레젠테이션)\n\n【전담 강사 1:1 멘토링】\n• 개별 주제별 전문 지도\n• 완성도 높은 결과물"),
    
    ("대회 준비반 전문 시스템", 
     "【영어 분야】\n• 말하기 대회 (발음·유창성)\n• 에세이 대회 (논리적 글쓰기)\n• 독서감상문 (창의적 표현)\n\n【수학 분야】\n• 교내 경시대회\n• KMC (한국수학경시)\n• 수학올림피아드 준비\n\n【과학 분야】\n• 탐구대회 (실험 설계)\n• 발명품 경진대회"),
    
    ("2024년 JLS 진학실적", 
     "검증된 결과로 증명하는 실력\n\n🏆 특목고\n• 외대부고 3명 | 대일외고 2명\n• 인천과학고 4명 | 경기과학고 1명\n\n🏆 자사고\n• 하나고 1명 | 민족사관고 1명\n\n🏆 국제학교\n• 채드윅 2명 | KMLA 3명\n\n→ 청라 지역 최고 진학률 달성!"),
    
    ("실제 성공사례 1", 
     "👦 김○○ (청람중 → 외대부고)\n\n【JLS 수강 과정】\n• 중1: 소논문 기초반\n• 중2: 영어 말하기 대회반\n• 중3: 특목고 준비반\n\n【핵심 성공요인】\n• 2년간 체계적 소논문 지도\n• 영어 실력 + 발표 능력 완성\n• 목표 의식 명확한 학습"),
    
    ("실제 성공사례 2", 
     "👧 박○○ (청라중 → 인천과학고)\n\n【JLS 수강 과정】\n• 중1: 수학 심화반\n• 중2: 과학 탐구반\n• 중3: 과학고 준비반\n\n【핵심 성공요인】\n• 수학 실력 탄탄한 기초\n• R&E 프로젝트 완벽 수행\n• 과학적 사고력 체계적 개발"),
    
    ("학부모 생생한 후기", 
     "💬 \"체계적인 관리 시스템 덕분에\n    아이가 스스로 공부하게 됐어요.\"\n\n💬 \"소논문 지도가 정말 전문적이고\n    세밀해서 놀랐습니다.\"\n\n💬 \"진학 상담이 구체적이고 실질적\n    도움이 많이 됐어요.\"\n\n🏆 학부모 만족도 95% 달성!"),
    
    ("맞춤형 입시 컨설팅", 
     "【1단계】정확한 진단\n• 현재 학력 수준 분석\n• 성향 및 적성 파악\n• 가정환경 고려\n\n【2단계】개별 설계\n• 3개년 로드맵 작성\n• 단계별 목표 설정\n• 과목별 학습 전략\n\n【3단계】지속 관리\n• 정기 점검 및 수정\n• 학부모 상담\n• 동기부여 시스템"),
    
    ("학교별 맞춤 대응전략", 
     "【청라중】영어 특화 + 국제적 감각\n• 원어민 수업 완벽 대비\n• 국제교류 프로그램 활용\n\n【청람중】수학·과학 심화 + 창의성\n• 심화 과정 선행 준비\n• 탐구 프로젝트 전문 지도\n\n【기타 학교】개별 특성 맞춤\n• 학교별 내신 패턴 분석\n• 차별화된 준비 전략"),
    
    ("체계적 상담 시스템", 
     "【월례 학습 상담】\n• 학습 진도 점검\n• 성취도 분석\n• 보완점 도출\n\n【진학 상담】\n• 학기별 진로 방향 점검\n• 목표 학교 구체화\n• 준비 전략 수정\n\n【학부모 간담회】\n• 정보 공유 및 소통\n• 네트워킹 기회\n• 성공 경험 공유"),
    
    ("JLS 특별 서비스", 
     "【학습 자료 제공】\n• 학교별 기출문제 DB\n• 예상문제 및 해설\n• 최신 기출 트렌드 분석\n\n【정보 서비스】\n• 실시간 입시 동향\n• 정책 변화 신속 공유\n• 전략 수정 제안\n\n【멘토링 시스템】\n• 선배와의 만남\n• 실전 경험담 공유"),
    
    ("핵심 메시지 요약", 
     "중학교 선택이 미래를 결정합니다\n\n✅ 교육제도 대변화 시대 대비\n✅ 전략적 중학교 선택 필수\n✅ 체계적 준비로 경쟁력 확보\n✅ 학부모의 현명한 지원 역할\n✅ JLS와 함께하는 성공 로드맵\n\n→ 지금이 바로 시작할 때입니다!"),
    
    ("오늘부터 실천할 일", 
     "🎯 오늘 할 일\n• 아이와 진솔한 대화 나누기\n• 진로와 꿈에 대해 들어보기\n• 중학교에 대한 생각 확인\n\n🎯 이번 주 할 일\n• 관심 중학교 정보 수집\n• 학교 홈페이지 상세 확인\n• 설명회 일정 체크\n\n🎯 이번 달 할 일\n• JLS 상담 예약\n• 학력 진단 테스트 받기"),
    
    ("특별 혜택 안내", 
     "🎁 오늘 현장 등록 시\n• 입학금 50% 할인\n• 첫 달 수업료 30% 할인\n\n🎁 무료 서비스 제공\n• 학력 진단 테스트\n• 1:1 개별 상담\n• 맞춤형 학습 계획 수립\n\n⏰ 기한: 오늘까지 (선착순 20명)"),
    
    ("상담 예약 방법", 
     "📞 전화 예약\n• 032-XXX-XXXX\n• 평일 10:00-22:00\n• 주말 10:00-18:00\n\n🖥️ 온라인 예약\n• www.jls-academy.com\n• 24시간 언제나 가능\n\n🏫 방문 예약\n• 현장에서 즉시 상담 가능\n• 준비물: 최근 성적표"),
    
    ("질문과 답변", 
     "❓ 궁금한 점이 있으시면\n   언제든지 질문해 주세요!\n\n📋 복잡한 개별 상황은\n   별도 상담에서 자세히\n   상담해 드리겠습니다.\n\n💡 작은 질문도 소중합니다.\n   주저하지 마시고\n   편안하게 말씀해 주세요."),
    
    ("JLS 정상어학원 연락처", 
     "🏫 JLS 정상어학원 청라캠퍼스\n\n📍 주소: 인천시 서구 청라동 000-0\n          청라 에듀타운 3층\n\n📞 전화: 032-XXX-XXXX\n📧 이메일: info@jls-academy.com\n🌐 홈페이지: www.jls-academy.com\n\n🚗 주차: 건물 지하 무료주차장"),
    
    ("감사 인사", 
     "🌟 우리 아이들의 꿈을 함께 키워가겠습니다\n\n• 전문적이고 체계적인 교육으로\n• 한 명 한 명 소중히 여기며\n• 성공까지 끝까지 함께 하겠습니다\n\n감사합니다! 🙏\n\n— JLS 정상어학원 임직원 일동 —")
]

# 100슬라이드 맞춤 (부족하면 빈 슬라이드 추가)
while len(slide_data) < 100:
    slide_data.append(("", ""))

if __name__ == "__main__":
    # 방법 1: 직접 폰트 크기 지정해서 생성 (추천)
    print("📝 PPT 생성 중... (폰트 크기 조정 포함)")
    
    # 제목 14pt, 내용 10pt로 생성
    filename = create_presentation_with_font_control(
        slide_data, 
        "JLS_중학교_전략_설명회_완성본_작은폰트.pptx",
        title_size=14,  # 제목 폰트 크기
        content_size=10  # 내용 폰트 크기
    )
    
    print(f"✅ 완료! {filename} 파일이 생성되었습니다.")
    print("📊 총 100슬라이드, 120분 분량 (폰트 크기 최적화됨)")
    print("📏 제목: 14pt, 내용: 10pt로 설정")
    print("🚀 더 작게 하려면: quick_font_adjust(filename, 'small')")
    print("🔍 더 크게 하려면: quick_font_adjust(filename, 'large')")
    
    # 방법 2: 기존 방식으로 생성 후 폰트 조정 (참고용)
    print("\n📝 기존 방식 PPT도 생성 중...")
    prs = Presentation()
    for title, content in slide_data:
        slide = prs.slides.add_slide(prs.slide_layouts[1])  # 제목+본문 레이아웃
        slide.shapes.title.text = title if title else " "
        if content:
            try:
                slide.placeholders[1].text = content
            except:
                pass
    
    original_filename = "JLS_중학교_전략_설명회_완성본_원본.pptx"
    prs.save(original_filename)
    
    # 기존 PPT 파일의 폰트를 80% 크기로 축소
    adjusted_filename = adjust_font_size(original_filename, scale_factor=0.8)
    
    print(f"✅ 원본: {original_filename}")
    print(f"✅ 조정본: {adjusted_filename}")
    
    print("\n🎯 사용법:")
    print("1. 폰트가 너무 클 때:")
    print("   adjust_font_size('파일명.pptx', 0.8)  # 20% 축소")
    print("   quick_font_adjust('파일명.pptx', 'small')  # 간편방법")
    
    print("\n2. 폰트가 너무 작을 때:")
    print("   adjust_font_size('파일명.pptx', 1.2)  # 20% 확대")
    print("   quick_font_adjust('파일명.pptx', 'xlarge')  # 간편방법")
    print("\n📞 추가 조정이 필요하면 adjust_font_size() 함수를 사용하세요!")
